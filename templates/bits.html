{% macro metadata_table(metadata, show_stage=True) %}

  <table class="datatable">

    <tr>
      <th>Country</th>
      <td>{{ COUNTRY_MAP[metadata['country']] }}</td>
    </tr>

    <tr>
      <th>Theme</th>
      <td>{{ THEME_MAP[metadata['theme']] }}</td>
    </tr>

    <tr>
      <th>Projection</th>
      <td>{{ PROJECTION_MAP[metadata['projection']] }}</td>
    </tr>

    <tr>
      <th>Spatial resolution</th>
      <td>{{ RESOLUTION_MAP[metadata['resolution']] }}</td>
    </tr>

    <tr>
      <th>Extent</th>
      <td>{{ EXTENT_MAP[metadata['extent']] }}</td>
    </tr>

    {% if show_stage %}
    <tr>
      <th>Processing stage</th>
      <td>{{ STAGE_MAP[metadata['stage']] }}</td>
    </tr>
    {% endif %}

  </table>

{% endmacro %}


{% macro files_table(folder_path, parcel=None) %}

  {% set files = folder_path.listdir() %}

  {% if files %}

    <ul>
    {% for file_path in files %}
      <li>
      {% if parcel %}
        {% set url = url_for('parcel.download',
                             name=parcel.name, filename=file_path.name) %}
        <a href="{{ url }}">{{ file_path.name }}</a>
      {% else %}
        {{ file_path.name }}
      {% endif %}
      ({{ file_path.getsize() }} bytes)
      </li>
    {% endfor %}
    </ul>

  {% else %}

    <p><i>No files uploaded.</i></p>

  {% endif %}

{% endmacro %}


{% macro parcels_table(parcels_list) %}
  <table class="datatable">

    <thead>
      <th>Country</th>
      <th>Theme</th>
      <th>Projection</th>
      <th>Resolution</th>
      <th>Extent</th>
      <th>Stage</th>
    </thead>

    <tbody>
    {% for parcel in parcels_list %}
      <tr>
        {% set url = url_for('parcel.view', name=parcel.name) %}
        {% set metadata = parcel.metadata %}
        <td>{{ COUNTRY_MAP[metadata['country']] }}</td>
        <td>{{ THEME_MAP[metadata['theme']] }}</td>
        <td>{{ PROJECTION_MAP[metadata['projection']] }}</td>
        <td>{{ RESOLUTION_MAP[metadata['resolution']] }}</td>
        <td>{{ EXTENT_MAP[metadata['extent']] }}</td>
        <td><a href="{{ url }}">{{ STAGE_MAP[metadata['stage']] }}</a></td>
      </tr>
    {% endfor %}
    </tbody>

  </table>
{% endmacro %}


{% macro pick_from_list(id, name, items, any=False) -%}
  <select id="{{ id }}" name="{{ name }}">
  {% if any %}
    <option value="">Any {{ name|title }}</option>
  {% endif %}
  {% for key, label in items %}
    <option value="{{ key }}">{{ label }}</option>
  {% endfor %}
  </select>
{%- endmacro %}
